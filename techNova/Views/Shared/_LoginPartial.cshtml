@using Microsoft.AspNetCore.Identity

@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager

@{
    var userName = SignInManager.IsSignedIn(User)
        ? UserManager.GetUserName(User)
        : null;

    var initial = !string.IsNullOrWhiteSpace(userName)
        ? userName![0].ToString().ToUpper()
        : "?";
}

<ul class="flex items-center gap-2 md:gap-3 text-xs md:text-sm">

    @if (SignInManager.IsSignedIn(User))
    {
        <!-- Usuario autenticado -->
        <li>
            <div class="flex items-center gap-2 md:gap-3 px-3 py-1.5 rounded-full border border-neutral-200 bg-white shadow-sm">
                <!-- Avatar circular -->
                <div class="relative">
                    <div class="h-8 w-8 rounded-full bg-neutral-900 flex items-center justify-center text-xs font-semibold text-neutral-50 uppercase">
                        @initial
                    </div>
                    <span class="absolute -bottom-0.5 -right-0.5 h-3 w-3 rounded-full bg-emerald-500 border border-white"></span>
                </div>

                <!-- Información -->
                <div class="hidden sm:flex flex-col leading-tight">
                    <span class="text-[0.65rem] uppercase tracking-wide text-neutral-400">
                        Sesión activa
                    </span>
                    <a id="manage"
                       asp-area="Identity"
                       asp-page="/Account/Manage/Index"
                       title="Administrar perfil"
                       class="text-[0.75rem] font-semibold text-neutral-900 hover:text-neutral-950 hover:underline">
                        @userName
                    </a>
                </div>

                <!-- Botón cerrar sesión (icono) -->
                <form id="logoutForm"
                      class="inline-flex"
                      asp-area="Identity"
                      asp-page="/Account/Logout"
                      asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                    <button id="logout"
                            type="submit"
                            class="inline-flex items-center justify-center h-8 w-8 rounded-full border border-neutral-200 text-neutral-500 hover:text-rose-600 hover:border-rose-300 hover:bg-rose-50 transition-colors"
                            title="Cerrar sesión">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             class="h-4 w-4"
                             viewBox="0 0 24 24"
                             fill="none"
                             stroke="currentColor"
                             stroke-width="2"
                             stroke-linecap="round"
                             stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                            <polyline points="16 17 21 12 16 7" />
                            <line x1="21" y1="12" x2="9" y2="12" />
                        </svg>
                    </button>
                </form>
            </div>
        </li>
    }
    else
    {
        <!-- Usuario NO autenticado -->
        <li>
            <a id="login"
               asp-area="Identity"
               asp-page="/Account/Login"
               class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-neutral-300 text-[0.75rem] font-medium text-neutral-700 bg-white hover:bg-neutral-50 hover:border-neutral-400 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg"
                     class="h-4 w-4"
                     viewBox="0 0 24 24"
                     fill="none"
                     stroke="currentColor"
                     stroke-width="2"
                     stroke-linecap="round"
                     stroke-linejoin="round">
                    <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                    <polyline points="10 17 15 12 10 7" />
                    <line x1="15" y1="12" x2="3" y2="12" />
                </svg>
                Iniciar sesión
            </a>
        </li>

        <li>
            <a id="register"
               asp-area="Identity"
               asp-page="/Account/Register"
               class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-neutral-900 text-[0.75rem] font-medium text-neutral-50 hover:bg-neutral-800 shadow-sm transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg"
                     class="h-4 w-4"
                     viewBox="0 0 24 24"
                     fill="none"
                     stroke="currentColor"
                     stroke-width="2"
                     stroke-linecap="round"
                     stroke-linejoin="round">
                    <path d="M12 5v14" />
                    <path d="M5 12h14" />
                </svg>
                Registrarse
            </a>
        </li>
    }
</ul>
    